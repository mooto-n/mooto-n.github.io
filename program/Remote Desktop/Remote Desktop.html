<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" charset="Shift_JIS">
</head>
<body>
<p>
@echo off<br>
:LOOP<br>
<br>
Set INPUT_HOSTNAME="ホスト名: "<br>
Set INPUT_USERNAME="ユーザー名: "<br>
Set INPUT_PASSWORD="パスワード: "<br>
<br>
rem ローカル利用時に個別設定<br>
Set DF_HOSTNAME="<HOSTNAME>"<br>
Set DF_USERNAME="<USERNAME>"<br>
Set DF_PASSWORD="<PASSWORD>"<br>
<br>
rem 0:１回のみ・1: ループする<br>
Set LOOP_FLAG=0<br>
<br>
rem 未定義チェック<br>
if not defined DF_HOSTNAME ( Set /P DF_HOSTNAME=%INPUT_HOSTNAME%<br>
) else ( echo %INPUT_HOSTNAME%%DF_HOSTNAME% )<br>
if not defined DF_USERNAME ( Set /P DF_USERNAME=%INPUT_USERNAME%<br>
) else ( echo %INPUT_USERNAME%%DF_USERNAME% )<br>
if not defined DF_PASSWORD ( Set /P DF_PASSWORD=%INPUT_PASSWORD%<br>
) else ( echo %INPUT_PASSWORD%%DF_PASSWORD% )<br>
<br>
rem 実行<br>
Cmdkey /generic:TERMSRV/%DF_HOSTNAME% /user:%DF_USERNAME% /pass:%DF_PASSWORD%<br>
Start mstsc /v:%DF_HOSTNAME%<br>
Timeout 3<br>
Cmdkey /delete:TERMSRV/%DF_HOSTNAME%<br>
<br>
if ( %LOOP_FLAG% == 1 ) {<br>
	Set /P LOOP_ENTER="ENTERキーでループ"<br>
	cls<br>
	goto LOOP<br>
}<br>
<br>
exit<br>
</p>

</body>
</html>
